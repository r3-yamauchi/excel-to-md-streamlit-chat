# Excel to Markdown Converter Chat

ExcelファイルをMarkdown形式に変換するStreamlitチャットアプリケーション

## 📊 概要

このアプリケーションは、XLSX形式のExcelファイルをMarkdown形式に変換し、チャットインターフェースを通じて直感的に操作できるツールです。複数シートの選択的変換、自動プレビュー表示、エラーハンドリングなど、実用的な機能を備えています。

## ✨ 主な機能

### 基本機能
- 📁 **ドラッグ&ドロップ対応**: XLSXファイルを簡単にアップロード
- 📋 **複数シート対応**: 必要なシートのみを選択して変換
- 🔄 **自動プレビュー**: 変換完了後、自動的に結果をチャット内に表示
- 💬 **チャットコマンド**: スラッシュコマンドでの直感的な操作

### 高度な機能
- ⚙️ **柔軟な変換オプション**: インデックス表示の有無、列幅の調整（10〜100文字）
- 🛡️ **堅牢なエラーハンドリング**: シートごとの個別エラー処理、部分的な変換成功にも対応
- 📊 **プログレス表示**: 大きなファイルでも進捗状況を確認可能
- 🔍 **詳細なエラー情報**: 変換失敗の原因を明確に表示

## 🚀 クイックスタート

### 前提条件
- Python 3.9以上
- uv（推奨）またはpip

### インストール

#### uvを使用する場合（推奨）

```bash
# リポジトリをクローン
git clone <repository-url>
cd excel-to-md-streamlit-chat

# 依存関係をインストール
uv sync

# アプリケーションを起動
uv run streamlit run app.py
```

#### pipを使用する場合

```bash
# リポジトリをクローン
git clone <repository-url>
cd excel-to-md-streamlit-chat

# 仮想環境を作成・有効化
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# 依存関係をインストール
pip install -r requirements.txt

# アプリケーションを起動
streamlit run app.py
```

## 📖 使い方

### 1. ファイルのアップロード
サイドバーの「ファイルアップロード」セクションからXLSXファイルを選択またはドラッグ&ドロップ

### 2. シートの選択（複数シートの場合）
変換したいシートをチェックボックスで選択（デフォルトは全選択）

### 3. 変換オプションの設定
- **インデックスを含める**: 行番号を表示するかどうか
- **最大列幅**: 各列の最大文字数（10〜100）

### 4. 変換の実行
「🔄 Markdownに変換」ボタンをクリック

### 5. 結果の確認
変換が完了すると：
- ✅ 成功メッセージが表示
- 📋 **自動的に変換結果のプレビューが表示**
- 💡 ダウンロード方法の案内が表示

### 6. チャットコマンド
チャット欄で以下のコマンドを入力：
- `/download` または「ダウンロード」: 変換結果をMarkdownファイルとしてダウンロード
- `/preview` または「プレビュー」: 変換結果を再度表示
- `/error` または「エラー」: 変換時のエラー詳細を確認

## 🛠️ 高度な使用方法

### デバッグモード
```bash
uv run streamlit run app.py --logger.level=debug
```

### アップロードサイズ制限の変更
```bash
# 500MBに変更
uv run streamlit run app.py --server.maxUploadSize=500
```

### ポート変更
```bash
uv run streamlit run app.py --server.port=8502
```

## 📦 技術スタック

| ライブラリ | バージョン | 用途 |
|-----------|----------|------|
| streamlit | 最新 | Webアプリケーションフレームワーク |
| pandas | 2.3.0 | Excel読み込みとデータ処理 |
| openpyxl | 3.1.5 | XLSXファイル解析エンジン |
| tabulate | 0.9.0 | Markdownテーブル変換 |

## ⚠️ 制限事項

### ファイル形式
- 対応形式: XLSX（Excel 2007以降）のみ
- XLS形式（Excel 97-2003）は非対応

### 処理能力
- デフォルトのアップロードサイズ制限: 200MB
- 大きなファイルはメモリエラーの可能性あり
- 数万行を超えるシートは処理時間が長くなる

### 変換精度
- 複雑な書式（結合セル、画像、グラフ）は無視される
- 数式は計算結果のみが変換される
- パスワード保護されたファイルは読み込み不可

## 🔧 トラブルシューティング

### ファイルが読み込めない
1. ファイル形式が`.xlsx`であることを確認
2. ファイルが破損していないか確認
3. 他のアプリケーションで開いていないか確認
4. パスワード保護されていないか確認

### 変換エラーが発生する
1. チャットで `/error` コマンドを入力して詳細を確認
2. 特殊文字や複雑な書式が原因の可能性
3. メモリ不足の場合は、より小さいファイルで試す

### 文字化けする
- ファイルのエンコーディングを確認
- 特殊文字を含むセルを確認

## 🤝 貢献

プルリクエストを歓迎します。大きな変更の場合は、まずissueを作成して議論してください。

### 開発者向け情報
詳細な技術情報とアーキテクチャについては、[CLAUDE.md](./CLAUDE.md)を参照してください。

## 📄 ライセンス

[ライセンスを指定してください]

## 🙏 謝辞

このプロジェクトは以下のオープンソースプロジェクトを使用しています：
- Streamlit
- pandas
- openpyxl
- tabulate